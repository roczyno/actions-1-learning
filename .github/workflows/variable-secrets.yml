name: Exploring variables and secrets
on:
    workflow_dispatch:
    # schedule:
    #     - cron: "0 0 * * *" # Runs every day at midnight

env:
    DockerHubUsername: ${{ vars.DOCKER_HUB_USERNAME }}
    DockerHubPassword: ${{ secrets.DOCKER_HUB_PASSWORD }}
    Container_Registry: "docker.io"
    IMAGE_NAME: "nginx:latest"



jobs:
    docker:
        runs-on: ubuntu-latest
        steps:
            - name: Docker build
              run: "echo 'Building Docker image with tag: ${{ env.Container_Registry }}/${{ env.DockerHubUsername }}/${{ env.IMAGE_NAME }}'"

            - name: docker login
              run: "echo 'Logging in to Docker Hub with username: ${{ env.DockerHubUsername }}'"

            - name: docker publish
              run: "echo 'Publishing Docker image with tag:... ${{ env.Container_Registry }}/${{ env.DockerHubUsername }}/${{ env.IMAGE_NAME }}'"

    deploy:
        needs: docker
        concurrency:
            group: production-deploy
            cancel-in-progress: true
        runs-on: ubuntu-latest
        steps:
            - name: Deploy to production server
              run: "echo 'Deploying to production server with credentials: ${{ env.DockerHubUsername }}/${{ env.IMAGE_NAME }}'"
